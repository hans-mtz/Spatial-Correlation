## Evenly spaced locations (time series)

In this exercise, locations are evenly spaced from $\frac{1}{250}$ to 1. The error terms and the regressors are autocorrelated following an AR(1) process $e_{l+1}=\gamma e_l+ u_l$, where $u_l\sim N(0,1)$, and $\gamma=0.79$. Likewise, $x_{l+1}=\lambda x_l+ v_l$, where $v_l\sim N(0,1)$, and $\lambda=0.79$. The DGP for y is same as before $y_l=\beta_0+\beta_1 x_l+e_l$ with $(\beta_0, \beta_1)=(1, 1.5)$.

@tbl-grid displays the rejection frequencies of 500 simulations. SCPC is omitted because it could not find a reasonable value of $c_{min}$ for the default value of $\bar\rho=0.03$ with the evenly distributed locations.

@tbl-grid-ar1-mean displays the average coefficients of an AR(1) model using the residuals of the OLS regression without and with splines for every iteration.


```{r}
#| label: tbl-grid
#| tbl-cap: Rejection frequencies for different variance estimators
#| echo: false
#| warning: false

kernel_results <- read.csv("../Simulations/Products/grid_sims_res.csv")

# row_names <- c(
#     " ",
#     "HR",
#     "SCPC",
#     "0.01",
#     "0.03",
#     "0.05",
#     "0.07",
#     "0.01",
#     "0.03",
#     "0.05",
#     "0.07"
# )

row_names <- c(
    # " ",
    "HR",
    # "SCPC",
    rep(
        c(
            "0.015",
            "0.030",
            "0.050"
            # "0.07"
        ),
        9
    )
)

col_names <- c(
    "Estimator",
    rep(
        c(
            "Cons.",
            "$\\beta_1$"#,
            # "$\\beta_2$"
        ),
        1
    )
)

table <- cbind(row_names, kernel_results)

kbl(
    table, 
    digits=3, 
    booktabs = TRUE,
    col.names = col_names,
    # row.names = row_names,
    escape = F
    ) %>%
    add_header_above(
        c(" ","T.S. model"=2)#,"Model 2"=2)
    ) %>%
    pack_rows(
        "Kernel",3-1,5-1
    ) %>%
    pack_rows(
        "B-Splines order 1 (Step functions)",6-1,17-1, latex_align = "l", hline_after = TRUE
    ) %>%
    pack_rows(
        "B-Splines order 2 (Triangles)",18-1,29-1, latex_align = "l", hline_after = TRUE
    ) %>%
    pack_rows(
        "Kernel + B-S, 64 splines",6-1,8-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 80 splines",9-1,11-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 100 splines",12-1,14-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 125 splines",15-1,17-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 64 splines",18-1,20-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 80 splines",21-1,23-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 100 splines",24-1,26-1
    ) %>%
    pack_rows(
        "Kernel + B-S, 125 splines",27-1,29-1
    ) #%>%
 



```

```{r}
#| label: tbl-grid-ar1-mean
#| tbl-cap: Average coefficients of the AR(1) model for the residuals
#| echo: false
#| warning: false


e_ar1_tbl <- read.csv("../Simulations/Products/grid_sims_ar1.csv")



row_names_ar1 <- c(
    "No splines",
    rep(
        c(
        "64 splines",
        "80 splines",
        "100 splines",
        "125 splines"
        ),
        2
    )
)

col_names_ar1 <- c(
    "",
    rep(
        c(
            "Cons.",
            "$\\gamma$"#,
            # "$\\beta_2$"
        ),
        1
    )
)

table_ar1 <- cbind(row_names_ar1, e_ar1_tbl)

kbl(
    table_ar1, 
    digits=3, 
    booktabs = TRUE,
    col.names = col_names_ar1,
    # row.names = row_names,
    escape = F
    ) %>%
    add_header_above(
        c(" ","$e_l$ model 1"=2),
        # "$e_l$ model 2"=2),
        escape = FALSE
    ) %>%
    pack_rows(
        "B-Splines order 1 (Step functions)",2,5, latex_align = "l", hline_after = TRUE
    ) %>%
    pack_rows(
        "B-Splines order 2 (Triangles)",6,9, latex_align = "l", hline_after = TRUE
    )
 



```
